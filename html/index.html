<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <title>Ajax starting point</title>


  </head>

  <body>
    <div class="topnav">
    <a class="active" href="#home">Home</a>
    <a href="#about">About</a>
    <a href="#contact">Contact</a>
    <div class="search-container">
      <form action="/">
        <input id = "search-field" type="text" placeholder="Search.." name="search">
        <button id="search-button" type="submit"><i class="fa fa-search"></i></button>
      </form>
    </div>
  </div>
    
	<div id="candidate" class="row">
    </div>
    

    <script>
      var userChoice = document.querySelector('#search-button');
	    var poemDisplay = document.querySelector('#candidate');
	    var searchText = document.querySelector('#search-field');

	  userChoice.onclick = function() {
	  	var searchVal = searchText.value;
	  	updateDisplay(searchVal);
      };
      function updateDisplay(searchVal){
        searchVal = searchVal.replace(" ", "");
		    searchVal = searchVal.toLowerCase();
		    var url = '/address?zipCode=' + searchVal;
        fetch(url).then(function(response) {
			    response.text().then(function(text) {
			    var data = JSON.parse(text);
			    poemDisplay.innerHTML = "";
			    data.officials.forEach(myFunc)
  			  });
		    });
      };
      function myFunc(item,index,arr){
        var photo = './img_avatar.png';
        if(arr[index].photoUrl)
          photo = arr[index].photoUrl;
        poemDisplay.innerHTML += '<div class="column"><div class="candidate-display"><img src='+ photo +'><div id="candidate_1" class="container"><h3>'+arr[index].name +'</h3></div></div></div>';
      }
    </script>
  </body>
</html>